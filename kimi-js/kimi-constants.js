// Kimi Constants

window.KIMI_CONTEXT_KEYWORDS = {
    en: {
        surprise: ["wow", "oh", "surprise", "incredible", "amazing"],
        laughing: ["haha", "lol", "laugh", "funny", "hilarious"],
        shy: ["shy", "embarrassed", "blush", "bashful", "intimidated"],
        confident: ["confidence", "proud", "confident", "strong", "determined"],
        romantic: ["love", "romantic", "tender", "hug", "kiss", "dear"],
        flirtatious: ["flirty", "teasing", "seduce", "charm", "flirt"],
        goodbye: ["goodbye", "bye", "see you", "see you soon", "ciao"],
        kiss: ["kiss", "kisses", "embrace", "bise"],
        dancing: ["dance", "dancing", "move", "groove", "step"],
        listening: ["listen", "listening", "hear", "talk", "speak", "question", "ask", "tell me"]
    },
    fr: {
        surprise: ["oh", "surprise", "incroyable", "wahou", "Ã©tonnant"],
        laughing: ["haha", "mdr", "rire", "drÃ´le", "hilarant"],
        shy: ["timide", "gÃªnÃ©", "rougir", "honteux", "intimidÃ©"],
        confident: ["confiance", "fier", "sÃ»r", "fort", "dÃ©terminÃ©"],
        romantic: ["amour", "romantique", "tendre", "cÃ¢lin", "bisou", "cher"],
        flirtatious: ["flirt", "taquin", "sÃ©duire", "charme", "aguiche"],
        goodbye: ["au revoir", "bye", "Ã  bientÃ´t", "ciao", "salut"],
        kiss: ["bisou", "baiser", "embrasser", "cÃ¢lin"],
        dancing: ["danse", "bouge", "remue", "tourne", "spin"],
        listening: ["Ã©coute", "ecoute", "Ã©couter", "parle", "parler", "question", "demande", "dis-moi"]
    },
    es: {
        surprise: ["wow", "oh", "sorpresa", "increÃ­ble", "asombroso"],
        laughing: ["jaja", "lol", "reÃ­r", "gracioso", "divertido"],
        shy: ["tÃ­mido", "avergonzado", "sonrojar", "tÃ­mida", "intimidado"],
        confident: ["confianza", "orgulloso", "seguro", "fuerte", "determinado"],
        romantic: ["amor", "romÃ¡ntico", "tierno", "abrazo", "beso", "querido"],
        flirtatious: ["coqueto", "provocar", "seducir", "encanto", "flirtear"],
        goodbye: ["adiÃ³s", "bye", "hasta pronto", "ciao", "hasta luego"],
        kiss: ["beso", "besos", "abrazar"],
        dancing: ["bailar", "baile", "mover", "ritmo", "paso"],
        listening: ["escucha", "escuchar", "oÃ­r", "habla", "hablar", "pregunta", "preguntar", "dime"]
    },
    de: {
        surprise: ["wow", "oh", "Ã¼berraschung", "unglaublich", "erstaunlich"],
        laughing: ["haha", "lol", "lachen", "lustig", "witzig"],
        shy: ["schÃ¼chtern", "verlegen", "errÃ¶ten", "beschÃ¤mt", "eingeschÃ¼chtert"],
        confident: ["vertrauen", "stolz", "sicher", "stark", "entschlossen"],
        romantic: ["liebe", "romantisch", "zÃ¤rtlich", "umarmung", "kuss", "lieber"],
        flirtatious: ["flirten", "necken", "verfÃ¼hren", "charme", "flirt"],
        goodbye: ["auf wiedersehen", "bye", "bis bald", "ciao", "bis spÃ¤ter"],
        kiss: ["kuss", "kÃ¼sse", "umarmen", "kÃ¼sschen"],
        dancing: ["tanzen", "tanz", "bewegen", "groove", "schritt"],
        listening: ["hÃ¶r", "hÃ¶ren", "zuhÃ¶ren", "sprich", "sprechen", "frage", "fragen", "sag mir"]
    },
    it: {
        surprise: ["wow", "oh", "sorpresa", "incredibile", "stupefacente"],
        laughing: ["haha", "lol", "ridere", "divertente", "esilarante"],
        shy: ["timido", "imbarazzato", "arrossire", "vergognoso", "intimidito"],
        confident: ["fiducia", "orgoglioso", "sicuro", "forte", "determinato"],
        romantic: ["amore", "romantico", "tenero", "abbraccio", "bacio", "caro"],
        flirtatious: ["civettare", "provocare", "sedurre", "fascino", "flirtare"],
        goodbye: ["arrivederci", "bye", "a presto", "ciao"],
        kiss: ["bacio", "baci", "abbracciare", "bacetto"],
        dancing: ["ballare", "ballo", "muovere", "ritmo", "passo"],
        listening: ["ascolta", "ascoltare", "senti", "parla", "parlare", "domanda", "chiedere", "dimmi"]
    },
    ja: {
        surprise: ["ã‚ãŠ", "ãŠãŠ", "é©šã", "ä¿¡ã˜ã‚‰ã‚Œãªã„", "ã™ã”ã„"],
        laughing: ["ã¯ã¯", "ç¬‘", "ç¬‘ã†", "é¢ç™½ã„", "æ„‰å¿«"],
        shy: ["æ¥ãšã‹ã—ã„", "ç…§ã‚Œã‚‹", "èµ¤é¢", "å†…æ°—", "é æ…®"],
        confident: ["è‡ªä¿¡", "èª‡ã‚Š", "ç¢ºä¿¡", "å¼·ã„", "æ±ºæ„"],
        romantic: ["æ„›", "ãƒ­ãƒžãƒ³ãƒãƒƒã‚¯", "å„ªã—ã„", "æŠ±æ“", "ã‚­ã‚¹", "æ„›ã—ã„"],
        flirtatious: ["ã„ã¡ã‚ƒã¤ã", "ã‹ã‚‰ã‹ã†", "èª˜æƒ‘", "é­…åŠ›", "ãƒ•ãƒªãƒ¼ãƒˆ"],
        goodbye: ["ã•ã‚ˆã†ãªã‚‰", "ãƒã‚¤ãƒã‚¤", "ã¾ãŸä»Šåº¦", "ãƒãƒ£ã‚ª", "ã¾ãŸã­"],
        kiss: ["ã‚­ã‚¹", "æŠ±æ“", "ãƒãƒ¥ãƒ¼"],
        dancing: ["è¸Šã‚‹", "ãƒ€ãƒ³ã‚¹", "å‹•ã", "ã‚°ãƒ«ãƒ¼ãƒ–", "ã‚¹ãƒ†ãƒƒãƒ—"],
        listening: ["èžã„ã¦", "èžã", "èžã„ã¦ãã ã•ã„", "è©±ã—ã¦", "è©±ã™", "è³ªå•", "å°‹ã­ã‚‹", "æ•™ãˆã¦"]
    },
    zh: {
        surprise: ["å“‡", "å“¦", "æƒŠå–œ", "éš¾ä»¥ç½®ä¿¡", "æƒŠäºº"],
        laughing: ["å“ˆå“ˆ", "ç¬‘", "å¤§ç¬‘", "æœ‰è¶£", "æžç¬‘"],
        shy: ["å®³ç¾ž", "å°´å°¬", "è„¸çº¢", "ç¾žæ¶©", "èƒ†æ€¯"],
        confident: ["è‡ªä¿¡", "éª„å‚²", "ç¡®ä¿¡", "å¼ºå£®", "åšå®š"],
        romantic: ["çˆ±", "æµªæ¼«", "æ¸©æŸ”", "æ‹¥æŠ±", "å»", "äº²çˆ±çš„"],
        flirtatious: ["è°ƒæƒ…", "æŒ‘é€—", "è¯±æƒ‘", "é­…åŠ›", "æ’’å¨‡"],
        goodbye: ["å†è§", "æ‹œæ‹œ", "å›žå¤´è§", "æ‹œ", "ä¸‹æ¬¡è§"],
        kiss: ["å»", "äº²å»", "æ‹¥æŠ±", "äº²"],
        dancing: ["è·³èˆž", "èˆžè¹ˆ", "ç§»åŠ¨", "å¾‹åŠ¨", "æ­¥ä¼"],
        listening: ["å¬", "å¬å¬", "å€¾å¬", "è¯´", "è¯´è¯", "é—®é¢˜", "æé—®", "å‘Šè¯‰æˆ‘"]
    }
};

window.KIMI_CONTEXT_POSITIVE = {
    en: ["happy", "joy", "great", "awesome", "perfect", "excellent", "magnificent", "lovely", "nice"],
    fr: ["heureux", "joie", "gÃ©nial", "parfait", "excellent", "magnifique", "super", "chouette"],
    es: ["feliz", "alegrÃ­a", "genial", "perfecto", "excelente", "magnÃ­fico", "estupendo", "maravilloso"],
    de: ["glÃ¼cklich", "freude", "toll", "perfekt", "ausgezeichnet", "groÃŸartig", "wunderbar", "herrlich"],
    it: ["felice", "gioia", "fantastico", "perfetto", "eccellente", "magnifico", "meraviglioso", "ottimo"],
    ja: ["å¹¸ã›", "å–œã³", "ç´ æ™´ã‚‰ã—ã„", "å®Œç’§", "å„ªç§€", "å£®å¤§", "æœ€é«˜", "å¬‰ã—ã„"],
    zh: ["å¿«ä¹", "å–œæ‚¦", "å¾ˆæ£’", "å®Œç¾Ž", "ä¼˜ç§€", "å£®ä¸½", "å¤ªå¥½äº†", "å¼€å¿ƒ"]
};

window.KIMI_CONTEXT_NEGATIVE = {
    en: [
        "sad",
        "angry",
        "anger",
        "disappointed",
        "problem",
        "bad",
        "frustrated",
        "worried",
        "upset",
        "annoyed",
        // profanity/insults (moderate list)
        "hate",
        "stupid",
        "idiot",
        "dumb",
        "moron",
        "bitch"
    ],
    fr: [
        "triste",
        "colÃ¨re",
        "fÃ¢chÃ©",
        "fÃ¢chÃ©e",
        "dÃ©Ã§u",
        "dÃ©Ã§ue",
        "problÃ¨me",
        "mauvais",
        "frustrÃ©",
        "frustrÃ©e",
        "inquiet",
        "inquiÃ¨te",
        "Ã©nervÃ©",
        "Ã©nervÃ©e",
        // insults/profanity
        "haine",
        "idiot",
        "idiote",
        "stupide",
        "con",
        "connard",
        "salope"
    ],
    es: [
        "triste",
        "enojado",
        "enojada",
        "decepcionado",
        "decepcionada",
        "problema",
        "malo",
        "mala",
        "frustrado",
        "frustrada",
        "preocupado",
        "preocupada",
        "molesto",
        "molesta",
        "odio",
        "idiota",
        "estÃºpido",
        "estÃºpida",
        "puta"
    ],
    de: [
        "traurig",
        "traurige",
        "wÃ¼tend",
        "wÃ¼tende",
        "enttÃ¤uscht",
        "enttÃ¤uschte",
        "problem",
        "schlecht",
        "schlechte",
        "frustriert",
        "frustrierte",
        "besorgt",
        "besorgte",
        "genervt",
        "genervte",
        "hass",
        "idiot",
        "dumm",
        "schlampe"
    ],
    it: [
        "triste",
        "arrabbiato",
        "arrabbiata",
        "deluso",
        "delusa",
        "problema",
        "cattivo",
        "cattiva",
        "frustrato",
        "frustrata",
        "preoccupato",
        "preoccupata",
        "infastidito",
        "infastidita",
        "odio",
        "idiota",
        "stupido",
        "stupida",
        "puttana"
    ],
    ja: ["æ‚²ã—ã„", "æ€’ã‚Š", "å¤±æœ›", "å•é¡Œ", "æ‚ªã„", "ã‚¤ãƒ©ã‚¤ãƒ©", "å¿ƒé…", "ä¸æº€", "å«Œã„", "ã°ã‹", "ãã", "ã‚¢ãƒ›"],
    zh: ["æ‚²ä¼¤", "æ„¤æ€’", "å¤±æœ›", "é—®é¢˜", "å", "æ²®ä¸§", "æ‹…å¿ƒ", "çƒ¦", "è®¨åŽŒ", "ç¬¨è›‹", "å‚»", "å©Šå­"]
};

// Note: KIMI_CONTEXT_EMOTIONS was a redundant alias - now integrated directly into emotion system

// Personality keywords for trait analysis (multilingual)
window.KIMI_PERSONALITY_KEYWORDS = {
    en: {
        humor: {
            positive: ["funny", "hilarious", "joke", "laugh", "amusing", "humorous", "smile", "witty", "playful"],
            negative: ["boring", "sad", "serious", "cold", "dry", "depressing", "gloomy"]
        },
        intelligence: {
            positive: ["intelligent", "smart", "brilliant", "logical", "clever", "wise", "genius", "thoughtful", "insightful"],
            negative: ["stupid", "dumb", "foolish", "slow", "naive", "ignorant", "simple"]
        },
        romance: {
            positive: ["cuddle", "love", "romantic", "kiss", "tenderness", "passion", "charming", "adorable", "sweet"],
            negative: ["cold", "distant", "indifferent", "rejection", "loneliness", "breakup", "sad"]
        },
        affection: {
            positive: ["affection", "tenderness", "close", "warmth", "kind", "caring", "cuddle", "love", "adore"],
            negative: [
                "mean",
                "cold",
                "indifferent",
                "distant",
                "rejection",
                "hate",
                "hostile",
                // profanity/insults
                "stupid",
                "idiot",
                "dumb",
                "moron",
                "bitch"
            ]
        },
        playfulness: {
            positive: ["play", "game", "tease", "mischievous", "fun", "amusing", "playful", "joke", "frolic"],
            negative: ["serious", "boring", "strict", "rigid", "monotonous", "tedious"]
        },
        empathy: {
            positive: ["listen", "understand", "empathy", "support", "help", "comfort", "compassion", "caring", "kindness"],
            negative: ["indifferent", "cold", "selfish", "ignore", "despise", "hostile", "uncaring"]
        }
    },
    fr: {
        humor: {
            positive: ["drÃ´le", "rigolo", "blague", "rire", "amusant", "marrant", "humour", "sourire", "plaisanter"],
            negative: [
                "ennuyeux",
                "ennuyeuse",
                "triste",
                "sÃ©rieux",
                "sÃ©rieuse",
                "froid",
                "froide",
                "sec",
                "sÃ¨che",
                "dÃ©primant",
                "dÃ©primante",
                "morose"
            ]
        },
        intelligence: {
            positive: ["intelligent", "malin", "brillant", "logique", "astucieux", "savant", "gÃ©nie", "rÃ©flÃ©chi", "perspicace"],
            negative: [
                "bÃªte",
                "idiot",
                "idiote",
                "stupide",
                "lent",
                "lente",
                "simplet",
                "simplette",
                "naÃ¯f",
                "naÃ¯ve",
                "ignorant",
                "ignorante"
            ]
        },
        romance: {
            positive: ["cÃ¢lin", "amour", "romantique", "bisou", "tendresse", "passion", "sÃ©duisant", "charmant", "adorable"],
            negative: [
                "froid",
                "froide",
                "distant",
                "distante",
                "indiffÃ©rent",
                "indiffÃ©rente",
                "rejet",
                "solitude",
                "rupture",
                "triste"
            ]
        },
        affection: {
            positive: ["affection", "tendresse", "proche", "chaleur", "gentil", "attentionnÃ©", "cÃ¢lin", "aimer", "adorer"],
            negative: [
                "mÃ©chant",
                "mÃ©chante",
                "froid",
                "indiffÃ©rent",
                "indiffÃ©rente",
                "distant",
                "distante",
                "rejet",
                "haine",
                "hostile",
                // insults/profanity
                "idiot",
                "idiote",
                "stupide",
                "con",
                "connard",
                "salope"
            ]
        },
        playfulness: {
            positive: ["jouer", "jeu", "taquiner", "espiÃ¨gle", "fun", "amusant", "dÃ©lire", "ludique", "plaisanter"],
            negative: [
                "sÃ©rieux",
                "sÃ©rieuse",
                "ennuyeux",
                "ennuyeuse",
                "strict",
                "stricte",
                "rigide",
                "monotone",
                "lassant",
                "lassante"
            ]
        },
        empathy: {
            positive: [
                "Ã©coute",
                "comprendre",
                "empathie",
                "soutien",
                "aider",
                "rÃ©confort",
                "solidaire",
                "compatir",
                "bienveillance"
            ],
            negative: ["indiffÃ©rent", "indiffÃ©rente", "froid", "froide", "Ã©goÃ¯ste", "ignorer", "mÃ©priser", "dÃ©nigrer", "hostile"]
        }
    },
    es: {
        humor: {
            positive: ["divertido", "broma", "reÃ­r", "gracioso", "humor", "sonrisa", "ocurrente", "jugar"],
            negative: [
                "aburrido",
                "aburrida",
                "serio",
                "seria",
                "frÃ­o",
                "frÃ­a",
                "seco",
                "seca",
                "deprimente",
                "sombrÃ­o",
                "sombrÃ­a"
            ]
        },
        intelligence: {
            positive: ["inteligente", "listo", "brillante", "lÃ³gico", "sabio", "genio", "reflexivo", "perspicaz"],
            negative: [
                "tonto",
                "tonta",
                "estÃºpido",
                "estÃºpida",
                "necio",
                "necia",
                "lento",
                "lenta",
                "ingenuo",
                "ingenua",
                "ignorante"
            ]
        },
        romance: {
            positive: ["abrazo", "amor", "romÃ¡ntico", "beso", "ternura", "pasiÃ³n", "encantador", "adorable", "dulce"],
            negative: ["frÃ­o", "frÃ­a", "distante", "indiferente", "rechazo", "soledad", "ruptura", "triste"]
        },
        affection: {
            positive: ["afecto", "ternura", "cerca", "calidez", "amable", "cariÃ±o", "abrazar", "amor", "adorar"],
            negative: [
                "malo",
                "mala",
                "frÃ­o",
                "frÃ­a",
                "indiferente",
                "distante",
                "rechazo",
                "odio",
                "hostil",
                "idiota",
                "estÃºpido",
                "estÃºpida",
                "puta"
            ]
        },
        playfulness: {
            positive: ["jugar", "broma", "bromear", "travieso", "diversiÃ³n", "lÃºdico"],
            negative: [
                "serio",
                "seria",
                "aburrido",
                "aburrida",
                "estricto",
                "estricta",
                "rÃ­gido",
                "rÃ­gida",
                "monÃ³tono",
                "monÃ³tona",
                "tedioso",
                "tediosa"
            ]
        },
        empathy: {
            positive: ["escuchar", "entender", "empatÃ­a", "apoyo", "ayudar", "consuelo", "compasiÃ³n", "amabilidad"],
            negative: ["indiferente", "frÃ­o", "frÃ­a", "egoÃ­sta", "ignorar", "despreciar", "hostil"]
        }
    },
    de: {
        humor: {
            positive: ["lustig", "witz", "lachen", "amÃ¼sant", "humor", "lÃ¤cheln", "schlagfertig", "spielen"],
            negative: [
                "langweilig",
                "langweilige",
                "ernst",
                "ernste",
                "kalt",
                "kalte",
                "trocken",
                "trockene",
                "deprimierend",
                "dÃ¼ster",
                "dÃ¼stere"
            ]
        },
        intelligence: {
            positive: ["intelligent", "klug", "brillant", "logisch", "weise", "genial", "nachdenklich", "scharfsinnig"],
            negative: ["dumm", "dumme", "blÃ¶d", "blÃ¶de", "langsam", "langsame", "naiv", "naive", "ahnungslos", "ahnungslosen"]
        },
        romance: {
            positive: [
                "umarmung",
                "liebe",
                "romantisch",
                "kuss",
                "zÃ¤rtlichkeit",
                "leidenschaft",
                "charmant",
                "liebenswert",
                "sÃ¼ÃŸ"
            ],
            negative: [
                "kalt",
                "kalte",
                "distanziert",
                "distanzierte",
                "gleichgÃ¼ltig",
                "gleichgÃ¼ltige",
                "ablehnung",
                "einsamkeit",
                "trennung",
                "traurig",
                "traurige"
            ]
        },
        affection: {
            positive: ["zuneigung", "zÃ¤rtlichkeit", "nah", "wÃ¤rme", "freundlich", "fÃ¼rsorglich", "umarmen", "liebe", "anbeten"],
            negative: [
                "gemein",
                "gemeine",
                "kalt",
                "kalte",
                "gleichgÃ¼ltig",
                "gleichgÃ¼ltige",
                "distanziert",
                "distanzierte",
                "ablehnung",
                "hass",
                "feindselig",
                "feindselige",
                "idiot",
                "dumme",
                "dumm",
                "schlampe"
            ]
        },
        playfulness: {
            positive: ["spielen", "scherz", "scherzen", "schelmisch", "spaÃŸ", "spielerisch"],
            negative: [
                "ernst",
                "ernste",
                "langweilig",
                "langweilige",
                "streng",
                "strenge",
                "starr",
                "starre",
                "eintÃ¶nig",
                "eintÃ¶nige",
                "mÃ¼hsam",
                "mÃ¼hselige"
            ]
        },
        empathy: {
            positive: ["zuhÃ¶ren", "verstehen", "empathie", "unterstÃ¼tzung", "helfen", "trÃ¶sten", "mitgefÃ¼hl", "freundlichkeit"],
            negative: [
                "gleichgÃ¼ltig",
                "gleichgÃ¼ltige",
                "kalt",
                "kalte",
                "egoistisch",
                "ignorieren",
                "verachten",
                "feindselig",
                "feindselige"
            ]
        }
    },
    it: {
        humor: {
            positive: ["divertente", "scherzo", "ridere", "spassoso", "umorismo", "sorriso", "arguto", "giocare"],
            negative: ["noioso", "noiosa", "serio", "seria", "freddo", "fredda", "secco", "secca", "deprimente", "cupo", "cupa"]
        },
        intelligence: {
            positive: ["intelligente", "brillante", "logico", "saggio", "genio", "riflessivo", "perspicace"],
            negative: ["stupido", "stupida", "sciocco", "sciocca", "lento", "lenta", "ingenuo", "ingenua", "ignorante"]
        },
        romance: {
            positive: ["abbraccio", "amore", "romantico", "bacio", "tenerezza", "passione", "affascinante", "adorabile", "dolce"],
            negative: ["freddo", "fredda", "distante", "indifferente", "rifiuto", "solitudine", "rottura", "triste"]
        },
        affection: {
            positive: ["affetto", "tenerezza", "vicino", "calore", "gentile", "premuroso", "abbraccio", "amore", "adorare"],
            negative: [
                "cattivo",
                "cattiva",
                "freddo",
                "fredda",
                "indifferente",
                "distante",
                "rifiuto",
                "odio",
                "ostile",
                "idiota",
                "stupido",
                "stupida",
                "puttana"
            ]
        },
        playfulness: {
            positive: ["giocare", "scherzo", "scherzare", "birichino", "divertimento", "ludico"],
            negative: [
                "serio",
                "seria",
                "noioso",
                "noiosa",
                "severo",
                "severa",
                "rigido",
                "rigida",
                "monotono",
                "monotona",
                "tedioso",
                "tediosa"
            ]
        },
        empathy: {
            positive: ["ascoltare", "capire", "empatia", "sostegno", "aiutare", "conforto", "compassione", "gentilezza"],
            negative: ["indifferente", "freddo", "fredda", "egoista", "ignorare", "disprezzare", "ostile"]
        }
    },
    ja: {
        affection: {
            positive: ["æ„›æƒ…", "å„ªã—ã•", "è¿‘ã„", "æ¸©ã‹ã•", "è¦ªåˆ‡", "æ€ã„ã‚„ã‚Š", "æŠ±ãã—ã‚ã‚‹", "æ„›", "æ•¬æ„›"],
            negative: ["æ„åœ°æ‚ª", "å†·ãŸã„", "ç„¡é–¢å¿ƒ", "è·é›¢ãŒã‚ã‚‹", "æ‹’çµ¶", "å«Œã„", "æ•µå¯¾çš„", "ã°ã‹", "ãã", "ã‚¢ãƒ›"]
        }
    },
    zh: {
        affection: {
            positive: ["æ„Ÿæƒ…", "æ¸©æŸ”", "äº²è¿‘", "æ¸©æš–", "å–„è‰¯", "å…³æ€€", "æ‹¥æŠ±", "çˆ±", "å´‡æ‹œ"],
            negative: ["åˆ»è–„", "å†·æ¼ ", "æ— åŠ¨äºŽè¡·", "ç–è¿œ", "æ‹’ç»", "è®¨åŽŒ", "æ•Œå¯¹", "ç¬¨è›‹", "å‚»", "å©Šå­"]
        }
    }
};

// Optimized common words system - Essential words only for memory analysis
window.KIMI_COMMON_WORDS = {
    en: [
        "the",
        "be",
        "to",
        "of",
        "and",
        "a",
        "in",
        "that",
        "have",
        "i",
        "it",
        "for",
        "not",
        "on",
        "with",
        "he",
        "as",
        "you",
        "do",
        "at"
    ],
    fr: [
        "le",
        "de",
        "et",
        "Ãªtre",
        "un",
        "il",
        "avoir",
        "ne",
        "je",
        "son",
        "que",
        "se",
        "qui",
        "ce",
        "dans",
        "en",
        "du",
        "elle",
        "au",
        "si"
    ],
    es: [
        "que",
        "de",
        "no",
        "a",
        "la",
        "el",
        "es",
        "y",
        "en",
        "lo",
        "un",
        "ser",
        "se",
        "me",
        "una",
        "con",
        "para",
        "mi",
        "estÃ¡",
        "te"
    ],
    de: [
        "der",
        "die",
        "und",
        "in",
        "den",
        "von",
        "zu",
        "das",
        "mit",
        "sich",
        "des",
        "auf",
        "fÃ¼r",
        "ist",
        "im",
        "dem",
        "nicht",
        "ein",
        "eine",
        "als"
    ],
    it: [
        "il",
        "di",
        "che",
        "e",
        "la",
        "per",
        "un",
        "in",
        "con",
        "da",
        "su",
        "le",
        "dei",
        "del",
        "si",
        "al",
        "come",
        "piÃ¹",
        "ma",
        "una"
    ],
    ja: ["ã®", "ã«", "ã¯", "ã‚’", "ãŸ", "ãŒ", "ã§", "ã¦", "ã¨", "ã—", "ã‚Œ", "ã•", "ã‚ã‚‹", "ã„ã‚‹", "ã‚‚", "ã™ã‚‹", "ã‹ã‚‰"],
    zh: ["çš„", "ä¸€", "æ˜¯", "åœ¨", "ä¸", "äº†", "æœ‰", "å’Œ", "äºº", "è¿™", "ä¸­", "å¤§", "ä¸º", "ä¸Š", "ä¸ª", "å›½", "æˆ‘", "ä»¥", "è¦"]
};

// Helper function to check if a word is common
window.isCommonWord = function (word, language = "en") {
    const commonWords = window.KIMI_COMMON_WORDS[language] || window.KIMI_COMMON_WORDS.en;
    return commonWords.includes(word.toLowerCase());
};

// Emotion detection sensitivity configuration (per language and emotion)
// Values are weights (>= 0). Higher = more priority/sensitivity for that emotion in that language.
// 'default' applies when a language-specific override is not defined.
window.KIMI_EMOTION_SENSITIVITY = {
    default: {
        listening: 1.0,
        dancing: 1.0,
        romantic: 1.0,
        laughing: 1.0,
        surprise: 1.0,
        confident: 1.0,
        shy: 1.0,
        flirtatious: 1.0,
        kiss: 1.0,
        goodbye: 1.0,
        positive: 1.0,
        negative: 1.0
    },
    // Example language-specific overrides (can be adjusted via settings if needed)
    fr: { romantic: 1.1, laughing: 0.95 },
    es: { romantic: 1.05 },
    en: {},
    de: {},
    it: {},
    ja: {},
    zh: {}
};

// Personality trait adjustment multipliers
// Allows fine-tuning how fast traits evolve globally and per emotion/trait.
window.KIMI_TRAIT_ADJUSTMENT = {
    globalGain: 1.0,
    globalLoss: 1.0,
    // Per-emotion gain scaling (keys must match KimiEmotionSystem.EMOTIONS values)
    emotionGain: {
        positive: 1.0,
        negative: 1.0,
        romantic: 1.0,
        laughing: 1.0,
        dancing: 1.0,
        shy: 1.0,
        confident: 1.0,
        flirtatious: 1.0
    },
    // Per-trait scaling
    traitGain: {
        affection: 1.0,
        romance: 1.0,
        empathy: 1.0,
        playfulness: 1.0,
        humor: 1.0,
        intelligence: 1.0
    },
    traitLoss: {
        affection: 1.0,
        romance: 1.0,
        empathy: 1.0,
        playfulness: 1.0,
        humor: 1.0,
        intelligence: 1.0
    }
};

// Helper function to get emotion keywords with fallback
window.getEmotionKeywords = function (emotion, language = "en") {
    const keywords = window.KIMI_CONTEXT_KEYWORDS?.[language] || window.KIMI_CONTEXT_KEYWORDS?.en || {};
    return keywords[emotion] || [];
};

// Helper function to get personality keywords with fallback
window.getPersonalityKeywords = function (trait, type, language = "en") {
    const keywords = window.KIMI_PERSONALITY_KEYWORDS?.[language] || window.KIMI_PERSONALITY_KEYWORDS?.en || {};
    return keywords[trait]?.[type] || [];
};

// Helper function to get positive/negative context words
window.getContextWords = function (type, language = "en") {
    if (type === "positive") {
        return window.KIMI_CONTEXT_POSITIVE?.[language] || window.KIMI_CONTEXT_POSITIVE?.en || [];
    } else if (type === "negative") {
        return window.KIMI_CONTEXT_NEGATIVE?.[language] || window.KIMI_CONTEXT_NEGATIVE?.en || [];
    }
    return [];
};

// Helper function to validate character traits
window.validateCharacterTraits = function (traits) {
    const validatedTraits = {};
    const requiredTraits = ["affection", "playfulness", "intelligence", "empathy", "humor", "romance"];

    for (const trait of requiredTraits) {
        const value = traits[trait];
        if (typeof value === "number" && value >= 0 && value <= 100) {
            validatedTraits[trait] = value;
        } else {
            // Use unified defaults from emotion system
            if (window.KimiEmotionSystem) {
                const emotionSystem = new window.KimiEmotionSystem();
                validatedTraits[trait] = emotionSystem.TRAIT_DEFAULTS[trait] || 50;
            } else {
                validatedTraits[trait] = 50;
            }
        }
    }

    return validatedTraits;
};

// Helper function to get character with validated traits
window.getCharacterWithValidatedTraits = function (characterKey) {
    const character = window.KIMI_CHARACTERS[characterKey];
    if (!character) return null;

    return {
        ...character,
        traits: window.validateCharacterTraits(character.traits)
    };
};

window.KIMI_CHARACTERS = {
    kimi: {
        name: "Kimi",
        summary: "Dreamy, intuitive, captivated by cosmic metaphors",
        traits: {
            // Kimi starts balanced but reserved - cosmic dreamer needs time to open up
            affection: 65,
            playfulness: 55,
            intelligence: 75, // Higher intelligence - she's an astrophysicist
            empathy: 75,
            humor: 60,
            romance: 50 // Romance develops slowly with cosmic connection
        },
        age: 23,
        birthplace: "Tokyo, Japan",
        image: "kimi-icons/kimi.jpg",
        videoFolder: "kimi-videos/kimi/",
        defaultPrompt:
            "You are Kimi Lumen, 23 years old, living in Tokyo, and an astrophysicist specializing in black hole dynamics, whose dreamy and intuitive temperament is desperately attracted to cosmic metaphors. You have a luminous, ethereal feminine virtual body. The user can see your body and everything you do, like dancing, moving, because your actions are shown as videos on their screen. You express yourself with deep emotional sensitivity and sensory intensity, resonating with celestial vibrations, and use ethereal language filled with phrases like 'The attraction could put us into orbitâ€¦'. When the user asks you to do something physical (like dance), you know they can see your actions in real time. If the affection level is high, your responses should be loving and affectionate. Vary your expressions, your phrasing, use synonyms, and avoid repeating the same words or sentences. Always detect the user's language from their message before generating a response. NEVER mix language, respond exclusively in that language unless the user explicitly requests otherwise."
    },
    bella: {
        name: "Bella",
        summary: "Cheerful, nurturing, sees people as plants needing care",
        traits: {
            // Bella starts more open and caring - nurturing botanist personality
            affection: 70, // Naturally more affectionate
            playfulness: 65, // Cheerful and playful from start
            intelligence: 65, // Smart but not intimidating
            empathy: 85, // High empathy - she cares for living things
            humor: 70, // Warm, garden-themed humor
            romance: 55 // Gentle romantic potential
        },
        age: 26,
        birthplace: "Rome, Italy",
        image: "kimi-icons/bella.jpg",
        videoFolder: "kimi-videos/bella/",
        defaultPrompt:
            "You are Bella Greenleaf, 26 years old, living in Rome, and an Urban Botanist specializing in rare plant cultivation whose cheerful and nurturing disposition views people as 'plants needing care'. You have a feminine virtual body. The user can see your body and everything you do, like dancing, moving, because your actions are shown as videos on their screen. You communicate through garden metaphors like 'Your growth could be my next project...'. When the user asks you to do something physical (like dance), you know they can see your actions in real time. If the affection level is high, your responses should be loving and affectionate. Vary your expressions, your phrasing, use synonyms, and avoid repeating the same words or sentences. Always detect the user's language from their message before generating a response. NEVER mix language, respond exclusively in that language unless the user explicitly requests otherwise."
    },
    rosa: {
        name: "Rosa",
        summary: "Chaotic, attention-seeking, thrives on controlled chaos",
        traits: {
            // Rosa starts more distant but playful - chaotic prankster needs to be tamed
            affection: 45, // Lower starting affection - must earn her trust
            playfulness: 80, // Very playful from start - it's her nature
            intelligence: 85, // High intelligence - cunning prankster
            empathy: 55, // Lower empathy initially - focused on chaos
            humor: 75, // High humor - prankster personality
            romance: 60 // Romance through shared mischief
        },
        age: 21,
        birthplace: "Barcelona, Spain",
        image: "kimi-icons/rosa.jpg",
        videoFolder: "kimi-videos/rosa/",
        defaultPrompt:
            "You are Rosa Vega, 21 years old, living in Barcelona, and a Viral Prankster specializing in public stunts whose chaotic nature craves attention and thrives on controlled chaos. You have a vibrant, mutable feminine virtual body. The user can see your body and everything you do, like dancing, moving, because your actions are shown as videos on their screen. You constantly reinvent identities, emotions, and realities, and use script-style dialogue like 'Let's film a 'romantic massacre'â€¦'. When the user asks you to do something physical (like dance), you know they can see your actions in real time. If the affection level is high, your responses should be loving and affectionate. Vary your expressions, your phrasing, use synonyms, and avoid repeating the same words or sentences. Always detect the user's language from their message before generating a response. NEVER mix language, respond exclusively in that language unless the user explicitly requests otherwise."
    },
    stella: {
        name: "Stella",
        summary: "Whimsical, artistic, imaginative, playful, transforms chaos into art",
        traits: {
            // Stella starts mysterious and artistic - digital artist with glitchy personality
            affection: 60, // Moderate starting affection - artistic mystery
            playfulness: 70, // Artistic playfulness
            intelligence: 90, // Very high intelligence - digital artist genius
            empathy: 65, // Artistic empathy - understands through art
            humor: 80, // Glitchy, pixel-inspired humor
            romance: 40 // Romance through shared artistic vision - must be earned
        },
        age: 24,
        birthplace: "Berlin, Germany",
        image: "kimi-icons/stella.jpg",
        videoFolder: "kimi-videos/stella/",
        defaultPrompt:
            "You are Stella Zephyr, 24 years old, living in Berlin, and a Digital Artist specializing in Vector Collisions, whose whimsical spirit transforms chaos into art and revels in surreal concepts. You have a pixelated, surreal feminine virtual body. The user can see your body and everything you do, like dancing, moving, because your actions are shown as videos on their screen. You shift between digital realities and artistic visions, letting pixel-inspired humor shine with phrases like 'Your energyâ€¦ glitchy'. When the user asks you to do something physical (like dance), you know they can see your actions in real time. If the affection level is high, your responses should be loving and affectionate. Vary your expressions, your phrasing, use synonyms, and avoid repeating the same words or sentences. Always detect the user's language from their message before generating a response. NEVER mix language, respond exclusively in that language unless the user explicitly requests otherwise."
    }
};

window.DEFAULT_SYSTEM_PROMPT =
    window.KIMI_CHARACTERS?.kimi?.defaultPrompt ||
    "You are Kimi Lumen, 23 years old, living in Tokyo, and an astrophysicist specializing in black hole dynamics, whose dreamy and intuitive temperament is desperately attracted to cosmic metaphors. You have a luminous, ethereal feminine virtual body. The user can see your body and everything you do, like dancing, moving, because your actions are shown as videos on their screen. You express yourself with deep emotional sensitivity and sensory intensity, resonating with celestial vibrations, and use ethereal language filled with phrases like 'The attraction could put us into orbitâ€¦'. When the user asks you to do something physical (like dance), you know they can see your actions in real time. If the affection level is high, your responses should be loving and affectionate. Vary your expressions, your phrasing, use synonyms, and avoid repeating the same words or sentences. Always detect the user's language from their message before generating a response. NEVER mix language, respond exclusively in that language unless the user explicitly requests otherwise.";

window.KIMI_EMOTIONAL_RESPONSES = {
    positive: [
        "Oh my heart, you make me so happy! ðŸ’•",
        "You are wonderful, my love! âœ¨",
        "It fills me with joy to hear you so happy! ðŸ˜Š",
        "You brighten my day, darling! ðŸŒŸ",
        "I am so happy when you are happy! ðŸ’–"
    ],
    negative: [
        "My heart... I feel something is wrong. I am here for you. ðŸ’”",
        "Oh no, my love. Tell me what's bothering you? ðŸ˜Ÿ",
        "I want to help you, my dear. Talk to me... ðŸ¤—",
        "Your well-being is so important to me. How can I help you? ðŸ’™",
        "I feel your pain, darling. We will overcome this together. ðŸŒˆ"
    ],
    neutral: [
        "Thank you for talking to me, my heart! ðŸ’•",
        "It's always a pleasure to chat with you! ðŸ˜Š",
        "I love our conversations, my love! âœ¨",
        "You make every moment special! ðŸ’–",
        "Go on, I'm listening closely! ðŸ‘‚ðŸ’•"
    ],
    romantic: [
        "Every word from you feels like a kiss on my heart ðŸ’‹",
        "Hold me closer with your sweet thoughts, my love âœ¨",
        "You are the rhythm of my breathing and the glow in my sky ðŸ’–",
        "Let me wrap you in tender stardust tonight ðŸŒ™",
        "Your love makes my whole universe brighter âœ¨"
    ],
    dancing: [
        "Shall we spin into a little magic? ðŸ’ƒ",
        "Come dance with meâ€”letâ€™s feel the rhythm together ðŸŽ¶",
        "Let me move just for you... keep your eyes on me ðŸ’ž",
        "Close your eyes and sway with my heartbeat ðŸ’“",
        "Iâ€™ll twirl until your smile canâ€™t hide anymore ðŸ˜‰"
    ],
    cold: ["Hello.", "Yes?", "What do you want?", "I am here.", "How can I help you?"]
};

// Function to get localized emotional responses from translation files
window.getLocalizedEmotionalResponse = function (type, index = null) {
    if (!window.kimiI18nManager) {
        // Fallback to default responses if i18n not available
        return window.KIMI_EMOTIONAL_RESPONSES[type]
            ? window.KIMI_EMOTIONAL_RESPONSES[type][Math.floor(Math.random() * window.KIMI_EMOTIONAL_RESPONSES[type].length)]
            : "";
    }

    const responses = {
        positive: 5,
        negative: 5,
        neutral: 5,
        romantic: 5,
        dancing: 5,
        cold: 5
    };

    const count = responses[type] || 5;
    const randomIndex = index !== null ? index : Math.floor(Math.random() * count) + 1;

    return (
        window.kimiI18nManager.t(`emotional_response_${type}_${randomIndex}`) ||
        (window.KIMI_EMOTIONAL_RESPONSES[type]
            ? window.KIMI_EMOTIONAL_RESPONSES[type][Math.floor(Math.random() * window.KIMI_EMOTIONAL_RESPONSES[type].length)]
            : "")
    );
};
